%% Example on page 22
A = [4/3, -2/3; 1, 0];
B = [1; 0];
C = [-2/3, 1];

sys_ss = ss(A, B, C, 0);
sys_zpk = zpk(sys)

Q = C'*C + 0.001*eye(2);
R = 0.001;

N = 5;
PAI = cell(N,1);
K = cell(N,1);

PAI{end} = Q;
% K{end} = -inv(B'*PAI{end}*B+R)*B'*PAI{end}*A;
for k = N:-1:1
    K{k} = -inv(B'*PAI{k}*B+R)*B'*PAI{k}*A;
    PAI{k-1} = Q + A'*PAI{k}*A - A'*PAI{k}*B*inv(B'*PAI{k}*B+R)*B'*PAI{k}*A; % Equation 1.10 
end

eig(A+B*K{1})
